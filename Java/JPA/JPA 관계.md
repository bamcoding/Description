# JPA

## 단방향, 양방향
- 테이블
- 외래 키 하나로 양쪽 조인 가능
- 사실 방향이라는 개념이 없음

## 객체
- 참조용 필드가 있는 쪽으로만 참조 가능
- 한쪽만 참하면 단방향
- 양쪽이 서로 참조하면 양방향

테이블은 왜래 키 하나로 두 테이블이 연관관계를 맺음

객체 양방향 관계는 A에서 B, B에서 A처럼 참조가 2군데

객체 양방향 관게는 참조가 2군데 있음, 둘중 테이블의 왜 키를 관리할 곳을 지정해야함.

__연관관계의 주인__: 외래 키를 관리하는 참조
주인의 반대편: 외래 키에 영향을 주지 않음, 단숭 조회만 가능

## N:1 관계
- 테이블은 다대 1관계에서 다쪽에 외래키가 있어야 한다.
- 다대일 단방향 연관관계 매핑은 Member:Team이므로 member에서 team을 멤버변수로 가지고 있다. (연관관계의 주인)
- 다대일 양방향 연관관계 매핑은 Team에서 List<Member> members = new ArrayList<>(); @OneToMay(MmppedBy = "team")

## 1:N 관계
- 1쪽이 연관관계의 주인인 경우
- 실무에서는 거의 사용하지 않는다 지양한다. 테이블 방면에서 생각해보면 말이 안되는 구조이다.
- 객체와 테이블의 차이 때문에 반대편 테이블의 외래 키를 관리하는 특이한 구조
- @JoinColumn을 꼭 사용해야한다. 그렇지 않으면 조인 테이블 방식을 사용함.(테이블이 하나 추가됨)
- 이 관계는 트랜잭션 처리 단계에서 team.getMembers().add(member); 처럼 따로 처리해서 업데이트 문을 하나 더 수행한다.
- 멤버와 팀 테이블에 인서트했는데 맴버 테이블에 또다시 업데이트 문이 수행되는 헷갈리는 코드 생성.

### 일대다 단방향 정리
- 일대다 단방향 매칭의 단점.
- 엔티티가 관리하는 외래키가 다른 테이블에 있음.
- 연관관계 관리를 위해 추가로 업데이트 SQL을 실행.
- 일대다 단방향 매핑보다는 다대일 양방향 매핑을 사용하자.

### 일대다 양방향 정리
- 이런 매핑은 공식적으로 존재하지 않음
- @JoinColumn(insertable=false, updatable=false)
- 읽기 전용 필드를 사용해서 양방향처럼 사용하는 방법
- 다대일 양방향을 사용하자.

## 일대일 관계
- 일대일 관계는 그 반대도 일대일
- 주 테이블이나 대상 테이블 중에 외래 키 선택 가능
- 주 테이블에 외래 키 or 대상 테이블에 외래 키
- 외대 키에 데이터베이스 유니크 제약조건이 추가
- 가장 간단한 구현이 가능
- 외래키가 있는곳이 연관관계의 주인이 있고 반대편에 mappeedBy를 명시하여 양방향 구현이 가능하다.














