# 스프링 배치 원리

신라면세점에서 휴면처리 자동화 배치를 개발했습니다.

다른 기업에 면접을 가게 되었는데 면접관님이 해당 프로젝트에 대해 물어보시더군요.

단계적으로 간략히 설명했지만 면접관님이 궁금한 건 스프링 배치의 동작원리였던 것 같습니다.

저는 스프링 잡을 상속받아서 개발했는데 무슨 동작원리가 필요한 것일까... 저는 대답하지 못했습니다.

다음에는 해당 질문에 대답할 수 있도록 정리하려고 합니다.

기업에서 스프링 MVC에 원하는 기능은 스프링 MVC패턴, API, 배치가 중점인 것으로 예상됩니다.

## 배치 어플리케이션란?
배치는 일괄처리라는 뜻을 가지고 있습니다.

## 스프링 배치의 기본구조
1. Read(가져와서) : 원하는 조건의 데이터 레코드를 DB에서 읽어옵니다.
2. Processing(처리하고) : 읽어온 데이터를 비즈니스로직을 따라 처리합니다.
3. Write(저장합니다) : 처리된 데이터를 DB에 업데이트합니다.

```
<JobRepository>
	<JobLauncher>
		<Job>
			<Step>
				<ItemReader></ItemReader>
				<ItemProcessor></ItemProcessor>
				<ItemWriter></ItemWriter>
			</Step>
		</Job>
	</JobLauncher>
</JobRepository>
```

### 필요한 라이브러리
1. spring-batch-core
2. spring-batch-test

## 스프링 배치의 강점
1. 대용량 데이터 처리
2. 자동화
3. 견고성
4. 신뢰성
5. 성능

## 스프링 배치 개발 시 고려해야 될 사항
1. 단순한게
2. 안전하게
3. 가볍게
4. 스케쥴러가 아니다

## 스프링 배치에서 태스크릿, 청크란 무엇인가?
스프링 배치는 작업을 구현하기 위한 두 가지 다른 방법을 제공합니다.


### 1. Tasklet - 태스크릿 방식
모듈은 차례대로 실행되는 여러 단계로 구성됩니다. 각 단계는 하나의 정의돤 작업만 수행해야 합니다.
스프링 배치에서는 잡이 있습니다. 잡은 여러개의 Step으로 구성되고, Step은 Tasklet(기능)으로 구성됩니다.

```
<Job>
	<Step>
		<Tasklet>
			<ItemReader>
			<ItemProcessor>
			<ItemWriter>
		</Tasklet>
	</Step>
</Job>
```

- Tasklet 인터페이스를 생성한다.

### 2. Chunk - 청크 방식
데이터 청크에 대해 작업을 수행합니다. 즉, 한 번에 모든 행을 읽고 처리하고 쓰는 대신 한 번에 고정 된 양의 레코드를 읽고 처리합니다.

태스크릿은 단순하게 처리할 수 있는 장점이 있으나, 대용량을 감당하기엔 부하를 감당할 수 없습니다.
따라서 청크를 통해 쪼개서 넣을 필요가 있는데, 태스크릿으로도 ㄷ쪼개서 넣을 수 있지만, 가독성에서 떨어지기 때문에 권장하지 않습니다.


























